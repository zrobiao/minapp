<template>
  <view class="camera-container">
    <view class="title">{{title}}</view>
    <view class="camera">
      <camera device-position="back" flash="auto" binderror="error" wx:if="{{show}}"></camera>
    </view>
    <view class="tips">*请把证件放入上方框中，并拍摄清晰照片</view>
    <image src="../../images/motor.png" @tap="takePhoto" class="take-photo">
  </view>
</template>

<script>
import wepy from "wepy";
import base from "@/mixins/base.js";

export default class camera extends wepy.page {
  config = {
    navigationBarTitleText: "拍照",
    navigationBarBackgroundColor: "#191919",
    navigationBarTextStyle: "white",
    backgroundColor: "#191919",
    disableScroll: true
  };
  components = {};

  mixins = [base];

  data = {
    type: -1,
    title: "",
    show: false
  };

  computed = {};

  methods = {
    takePhoto() {
      this.ctx.takePhoto({
        quality: "high",
        success: res => {
          wx.setStorageSync(`path-${this.data.type}`, res.tempImagePath);
          wx.navigateBack({
            delta: 1
          });
        },
        fail: () => {
          this.$showToast("拍照失败");
        }
      });
    },
    error() {
      this.$alerts({
        content: "请授权使用摄像头进行行驶证、身份证等照片拍摄",
        confirmText: "去授权",
        showCancel: true,
        confirm: () => {
          wx.openSetting();
        },
        cancel: () => {
          wx.navigateBack({
            delta: 1
          });
        }
      });
    }
  };

  events = {};

  onLoad(options) {
    this.type = options.type;
    this.title = options.title;
  }

  onShow() {
    this.show = true;
    this.ctx = wx.createCameraContext();
  }
}
</script>

<style lang="less" scoped>
.camera-container{
  background: #191919;
  height:100%;
  .title {
    font-size: 30rpx;
    color: #fff;
    text-align: center;
  }

  .camera {
    display: block;
    margin: 0 auto;
    margin-top: 30rpx;
    width: 680rpx;
    height: 422rpx;
    padding: 8rpx;
    background: url("data:image/png;base64,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CCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABAhUB46zSpBwECBAgQIBAQsA4S9QoBAECBAgQIFARMM4qTcpBgAABAgQIJASMs0SNQhAgQIAAAQIVAeOs0qQcBAgQIECAQELAOEvUKAQBAgQIECBQETDOKk3KQYAAAQIECCQEjLNEjUIQIECAAAECFQHjrNKkHAQIECBAgEBCwDhL1CgEAQIECBAgUBEwzipNykGAAAECBAgkBIyzRI1CECBAgAABApsEvnz98fN3974++83v396Nt01Nu5UAAQIECBBYIWCcrajJkQQIECBAgMAVAePsStNyEiBAgAABAisEjLMVNTmSAAECBAgQuCJgnF1pWk4CBAgQIEBghYBxtqImRxIgQIAAAQJXBIyzK03LSYAAAQIECKwQMM5W1ORIAgQIECBA4IqAcXalaTkJECBAgACBFQLG2YqaHEmAAAECBAhcETDOrjQtJwECBAgQILBCwDhbUZMjCRAgQIAAgSsCxtmVpuUkQIAAAQIEVggYZytqciQBAgQIECBwRcA4u9K0nAQIECBAgMAKAeNsRU2OJECAAAECBK4IGGdXmpaTAAECBAgQWCFgnK2oyZEECBAgQIDAFQHj7ErTchIgQIAAAQIrBIyzFTU5kgABAgQIELgiYJxdaVpOAgQIECBAYIWAcbaiJkcSIECAAAECVwSMsytNy0mAAAECBAisEDDOVtTkSAIECBAgQOCKgHF2pWk5CRAgQIAAgRUCxtmKmhxJgAABAgQIXBEwzq40LScBAgQIECCwQsA4W1GTIwkQIECAAIErAsbZlablJECAAAECBFYIGGcranIkAQIECBAg8K8FPhtF//q//afff2048vu399efBvLnCBAgQIAAAQK/E9iwe4wz75cAAQIECBA4I2CcPVS1n5w9BOkzBAgQIEDguIBx9tADMM4egvQZAgQIECBwXMA4e+gBGGcPQfoMAQIECBA4LmCcPfQAjLOHIH2GAAECBAgQGC/wC6n+6qEevZp2AAAAAElFTkSuQmCC");
    -webkit-background-size: 100% 100%;
    background-size: 100% 100%;
    overflow: hidden;
  }

  .camera camera {
    width: 100%;
    height: 100%;
  }

  .tips {
    margin: 33rpx 0;
    color: #fff;
    text-align: center;
    font-size: 24rpx;
  }

  .take-photo {
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    bottom: 56rpx;
    display: block;
    width: 140rpx;
    height: 140rpx;
  }
}
</style>
